<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPX Map</title>
    <link rel="stylesheet" href="node_modules/leaflet/dist/leaflet.css" />
    <script src="node_modules/leaflet/dist/leaflet.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="node_modules/leaflet.elevation/dist/Leaflet.Elevation-0.0.2.css"/>
    <script src="node_modules/leaflet.elevation/dist/Leaflet.Elevation-0.0.2.min.js"></script>
    <style>
      html, body {
          height: 100%; /* Full height for both html and body */
          margin: 0;    /* Remove default margin */
      }
      #map {
          height: 100%; /* Full height for map container */
      }
  </style>

</head>
<body>
  <div id="map"></div>
    
    <script>
      window.addEventListener('load', () => {
          const map = L.map('map').setView([51.505, -0.09], 13);
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: 'Map data &copy; <a href="http://www.osm.org">OpenStreetMap</a>'
          }).addTo(map);
          
          // Retrieve the GPX data from localStorage
          const geoData = localStorage.getItem('geoData');
          if (geoData) {
              const geojson = JSON.parse(geoData);
              console.log(geoData)
              // Create height graph (elevation profile)
              var el = L.control.elevation();
              el.addTo(map);
              const geoJsonLayer = L.geoJSON(geojson, {
                  onEachFeature: el.addData.bind(el)
              }).addTo(map);

              // Fit the map bounds to the GeoJSON layer
              map.fitBounds(geoJsonLayer.getBounds());
          } else {
              alert('No GPX data found!');
          }
              
      });
    </script>
</body>
</html>
